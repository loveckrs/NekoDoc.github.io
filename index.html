<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>魔靈召喚2一鍵兌換</title><!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=GTM-WH4M38Q"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        
        gtag('config', 'GTM-WH4M38Q');
    </script>
</head>

<body>
    <p><span>*一鍵兌換*</span></p>
    <p><br></p>
    <p><span>CS Code : </span><input type="text" id="uid"></p>
    <p>請選擇伺服器 : 
  <select name="請選擇伺服器">
      <option value ="伺服器1">費得海</option> <option value ="saab">阿里爾</option>
       <option value="opel">Opel</option>
        </select></p>
<p><button onclick="req();">開始</button></p>
<hr>
  <p><span>[檢查/複製CS代碼的方法]</span></p>
<p>1. 從主選單中選擇’設定’鈕。</p>
<p>2. 在’設定-帳號’頁面中確認CS代碼。</p>
<p>3. 使用"複製鈕"複製CS代碼。</p>
    <hr>
    <p><br></p>
    <p><span>*編輯 兌換碼 !</span></p>
    <p><span>可以直接通過網頁臨時添加兌換碼，點擊運行即可兌換。如果你想將它添加到數據庫, <a href="https://docs.google.com/spreadsheets/d/1sgR9JXTRieL60ULy37ban54KWX5EiVxT7BOMCpz4BPk/edit?usp=drivesdk" rel="noopener noreferrer" target="_blank">點擊這裡</a></span></p>
    <p><br></p>
    <div id="example-table"><br></div>
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <p>
        <link href="https://unpkg.com/tabulator-tables@4.1.4/dist/css/tabulator.min.css" rel="stylesheet">
    </p>
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables@4.1.4/dist/js/tabulator.min.js"></script>
    <script>
        function setCookie(cookie_name, value, days) {
            var exdate = new Date();
            exdate.setDate(exdate.getDate() + days);
        
            var cookie_value = escape(value) + ((days == null) ? '' : '; expires=' + exdate.toUTCString());
            document.cookie = cookie_name + '=' + cookie_value;
        }
        
        function getCookie(cookie_name) {
            var x, y;
            var val = document.cookie.split(';');
        
            for (var i = 0; i < val.length; i++) {
                x = val[i].substr(0, val[i].indexOf('='));
                y = val[i].substr(val[i].indexOf('=') + 1);
                x = x.replace(/^\s+|\s+$/g, '');
                if (x == cookie_name) {
                    return unescape(y);
                }
            }
        
            return null
        }
        
        let uid = getCookie('uid')
        
        if (uid) { $('#uid').val(uid) }
        var tabledata = [
            { id: 1, code: "", result: 0, response: '', description: 'Request' },
            { id: 2, code: " ", result: 0, response: '', description: 'Request' },
            { id: 3, code: "", result: 0, response: '', description: 'Request' },
            { id: 4, code: "", result: 0, response: '', description: 'Request' },
            { id: 5, code: "", result: 0, response: '', description: 'Request' },
            { id: 6, code: "", result: 0, response: '', description: 'Request' },
            { id: 7, code: "", result: 0, response: '', description: 'Request' },
            { id: 8, code: "", result: 0, response: '', description: 'Request' },
            { id: 9, code: "", result: 0, response: '', description: 'Request' },
            { id: 10, code: "", result: 0, response: '', description: 'Request' },
        ];
        
        function req() {
            var uid = $('#uid').val()
            setCookie('uid', uid)
            for (var a in tabledata) {
                let i = a
                $.ajax({
                    type: 'POST',
                    url: 'https://couponview.netmarble.com/coupon/sk2gb/1461/apply',
                    data: {
                        'pid': uid,
                        'channelCode': 100,
                        'couponCode': tabledata[i]['code'],
                        'worldId': '',
                        'nickname': ''
                    },
                    success: function (data) {
                        if (data['resultCode'] === 'SUCCESS') {
                            tabledata[i]['result'] = 1
                            tabledata[i]['description'] = data['rewardItem']['rewardTitle']
                        } else if (data['resultCode'] === 'NOT_EXISTS_PID') {
                            tabledata[i]['description'] = 'NOT EXISTS UID'
                        } else if (data['resultCode'] === 'COUPON_ALREADY_USE') {
                            tabledata[i]['description'] = 'COUPON ALREADY USE'
                        } else if (data['resultCode'] === 'COUPON_WRONG') {
                            tabledata[i]['description'] = 'COUPON WRONG'
        			} else if (data['resultCode'] === 'COUPON_RESTRICT') {
                            tabledata[i]['description'] = 'COUPON RESTRICT. COUPON ENTRIES FAILED SUCCESSIVELY. CAN BE ENTERED AFTER 1 HOUR.'
                        } else {
                            tabledata[i]['description'] = 'UNKNOWN RESPONSE'
                        }
                        tabledata[i]['response'] = data['resultCode']
                        table.updateData(tabledata)
                    }
                })
            }
        }
        
        google.charts.load('current', { packages: ['corechart'] }).then(function () {
            var query = new google.visualization.Query('https://docs.google.com/spreadsheets/d/1sgR9JXTRieL60ULy37ban54KWX5EiVxT7BOMCpz4BPk/gviz/tq?tqx=out:html&tq=SELECT+B&gid=2000340401');
            
            query.send(function (response) {
                var dataTable = response.getDataTable();
                var jsonData = dataTable.toJSON();
                jsonData = JSON.parse(jsonData);
                for (var i = 0; i < jsonData.rows.length; i++) {
                    var htmlData = jsonData.rows[i].c[0].v;
                    tabledata[i]['code'] = htmlData;
                    table.updateData(tabledata);
                }
        
            });
        });
        
        var table = new Tabulator("#example-table", {
            data: tabledata,          
         //從數組中加載行數據
            reactiveData: true,
            layout: "fitColumns",  
         //使列適合表格的寬度
            responsiveLayout: "hide", 
         //隱藏不適合表格的列
            tooltips: true,   
         //在單元格上顯示工具提示
            addRowPos: "top",   
         //添加新行時，將其添加到表格的頂部
            history: true, 
         //允許對錶進行撤消和重做操作
            movableColumns: true, 
         //允許更改列順序
            resizableRows: true, 
         //允許更改行順序
            columns: [                 
         //定義表列
  { title: "No", field: "id", width: 70, editor: false },
  { title: "兌換碼", field: "code", width: 100, editor: "input" },
                {
                    title: "狀態",
                    field: "結果",
                    width: 90,
                    hozAlign: "center",
                    formatter: "tickCross",
                    sorter: "boolean",
                    editor: false
                },
                { title: "Response", field: "response", width: 180, editor: false },
                { title: "Description", field: "description", editor: false },
            ],
        });
    </script>

<div style="color: red">Created with <a href="https://wordtohtml.net/">WordToHTML.net</a> trial.</div>
</body>

</html>
